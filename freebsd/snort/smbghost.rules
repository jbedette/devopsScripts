alert tcp any any -> any 445 (
    msg:"SMBGhost Attempt - CVE-2020-0796 - SMBv3 Compression Vulnerability"; 
    flow:to_server,established; 
    content:"|FE 53 4D 42 40 00 00 00|"; 
    content:"|08|", offset 70, depth 1; 
    reference:cve,2020-0796; 
    classtype:attempted-admin; 
    sid:1000001; 
    rev:1;
)

alert tcp any any -> any 445 (
    msg:"SMBGhost Attempt - CVE-2020-0796 - SMBv3 Negotiation Response"; 
    flow:to_server,established; 
    content:"|11|", offset 4, depth 1; 
    content:"|00 00 00 00 00 00 00 00|", distance 64, within 8; 
    reference:cve,2020-0796; 
    classtype:attempted-admin; 
    sid:1000002; 
    rev:1;
)

alert tcp any any -> any 445 (
    msg:"SMBGhost Attempt - CVE-2020-0796 - SMBv3 Connection"; 
    flow:to_server,established; 
    content:"|40 00 00 00|", depth 4, offset 4; 
    reference:cve,2020-0796; 
    classtype:attempted-admin; 
    sid:1000003; 
    rev:1;
)
alert tcp any any -> any 445 
(
    msg:"!!! ANY 445 connection default test";
    classtype:attempted-admin;
    metadata:service smb;
    reference:cve,2020-0796;
    sid:1000004;
    rev:1;
)
